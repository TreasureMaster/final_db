# Итоговое SF (сервер 3)

Здесь описано решение пункта итогового задания SF:
- "Перенесите zabbix-server в Docker, то же самое сделайте с ELK и Grafana."
- На вашем PostgreSQL вам нужно будет создать копию тестовой базы с именем dbname_fortests с очищенными таблицами (но сохранением структуры) boarding_passes, Bookings.
- Доступ в pgadmin для ментора с учётными данными.

### Состав сборки

1. `postgres` - БД PostgreSQL
2. `pgadmin` - веб-интерфейс для PostgreSQL
3. `elasticsearch` - поисковая система
4. `kibana` - веб-интерфейс для ELK-стека

### Особенности сборки

1. Сборка основана на версии ELK-стека 7.17.1. Для совместимости лучше устанавливать все части той же версии,
   в том числе и Filebeat на другие сервера.
2. Настройки памяти для Elasticsearch нужно задавать в переменных окружения. Данной сборке необходимо
   минимум 8гб для работы: `"ES_JAVA_OPTS=-Xms4g -Xmx4g"`
3. Том `elasticsearch-data` используется для сохранения настроек ELK, в том числе созданных дашбордов.
4. Для создания контейнера с PostgreSQL был создан отдельный `Dockerfile`. Однако на данный момент он
   **не доработан**. Сейчас демонстрационная версия БД `demo-small` только скачивается, распаковывается
   и передается в контейнер. Но инициализироваться не может, так как в данной БД упрощенный SQL-скрипт.
   Скорее всего нужно преобразовать его в sh-скрипт. Поэтому нужно подключаться к контейнеру и устанавливать,
   копировать в `dbname-fortests`, удалять таблицы **вручную**.
   [Использованная ссылка](http://zetblog.ru/postgresql-kak-perenesti-dannye-iz-odnoy-bd-v-druguyu.html) по переносу БД.

### TODOs

1. Нужно попробовать устанавливать БД через sh-скрипт.